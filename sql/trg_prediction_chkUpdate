drop trigger if exists trg_chkUpdate;
DELIMITER $$

CREATE TRIGGER trg_chkUpdate BEFORE UPDATE ON prediction
 FOR EACH ROW begin
declare msg varchar(255);

IF  new.Gamedate<NOW() And new.Points=0 and old.Points=0 THEN
		set msg = 'NO PUEDE MODIFICAR PREDICCIONES DE PARTIDOS PASADOS O YA INICIADOS ';
        signal sqlstate '45000' set message_text = msg;
ELSEIF Hour(TIMEDIFF(new.Gamedate,NOW()))=0 and Minute(TIMEDIFF(new.Gamedate,NOW()))<=10 THEN
		set msg = 'Acceso de ModificaciÃ³n Denegado Exedio el Tiempo antes del inicio del partido ';
        signal sqlstate '45000' set message_text = msg;

ELSE
        SET NEW.PredictionDate=NOW();
END IF;

end
$$
DELIMITER ;